<!DOCTYPE html>
<html lang="zh">
<head>
    <title>发票查询-封存</title>
    <script type="text/javascript" src="/assets/self/main.js"></script>
</head>

<body>

<div class="mdui-container-fluid">
    <div class="receipts-container-border">
        <div class="mdui-container-fluid">
            <div class="mdui-row  receipts-op-panel">
                <div class="mdui-btn mdui-color-blue-grey-500 info-panel">
                    {{ .NickName }} | 封存
                </div>
                <div>
                    <button class="mdui-btn mdui-color-teal" onclick="updateResult({{ .Username }},'ensure')">确认</button>
                    <button class="mdui-btn mdui-color-teal" onclick="updateResult({{ .Username }},'unensure')">取消确认</button>
                    <button class="mdui-btn mdui-color-teal" onclick="toResult()">返回归档</button>
                </div>
                <div>
                    <button class="mdui-btn mdui-color-red" onclick="updateResult({{ .Username }},'sealed')">封存</button>
                    <button class="mdui-btn mdui-color-red" onclick="updateResult({{ .Username }},'unsealed')">取消封存</button>
                    <button class="mdui-btn mdui-color-red" onclick="removeResult({{ .Username }})">删除</button>
                </div>
                <div>
                    <button class="mdui-btn mdui-color-myself" onclick="editShowHideCol()">显示/隐藏列</button>
                    <button class="mdui-btn mdui-color-myself" onclick="filterResult()">过滤</button>
                    <button class="mdui-btn mdui-color-myself" onclick="outputAllResult({{ .Username }},'sealed')">
                        导出Excel
                    </button>
                    <a href="" download="封存导出.xlsx" id="hf"></a>
                </div>
                <div>
                    <button class="mdui-btn mdui-color-pink" onclick="showGuide('sealed.pdf')">
                        使用说明
                    </button>
                    <button class="mdui-btn mdui-color-pink" onclick="toQuery()">返回查询</button>
                    <button class="mdui-btn mdui-color-pink" onclick="toLogout()">切换账号</button>
                </div>
            </div>
            <div class="mdui-row">
                <table id="dg">
                </table>
            </div>
        </div>
    </div>
</div>

<script>

    let showHideColPara = {
        show: ['fpzt','fplx', 'jshjL', 'fpdm', 'fphm', 'kprq', 'yzmSj', 'jqbm', 'zpListString', 'gfName',
            'gfAddressTel', 'gfBankZh', 'sfName', 'sfBankZh', 'sfAddressTel', 'bz'],
        hide: ['jshjU', 'jym', 'qd', 'gfNsrsbh', 'sfNsrsbh', 'fxqy'],
    };
    let dgSelector = $('#dg');

    if ($.cookie("showHidePara") != null) {
        showHideColPara = JSON.parse($.cookie("showHidePara"));
    }

    dgSelector.datagrid({
        width:'100%',
        remoteSort: false,
        rownumbers: true,
        pagination: true,
        pageNumber: 1,
        pageSize: 20,
        pageList: [5,10,20,50,100,500,1000],
        nowrap:true,
        fitColumns: true,
        url: '/result/data',
        loadMsg: "请求数据中，请等待...",
        queryParams: {
            "username": {{ .Username }},
            "filter": "sealed='1'",
            "resultid": "0",
            "operation": "getdata"
        },
        striped: true,
        multiSort: true,
        autoRowHeight: false,
        method: 'post',
        selectOnCheck: true,
        checkOnSelect: true,
        idField: 'resultid',
        loadFilter: pagerFilter,
        frozenColumns: [[
            {field:'ck',checkbox:true,width:"10px"},
            {field:'resultid',title:'resultid',align:'center',hidden:true,width:"0px",sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'ensured',title:'确认状态',align:'center',width:"80px",sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'respMsg',title:'验证状态',align:'center',width:"140px",sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
        ]],
        columns:[[
            {field:'fpzt',title:'发票状态',align:'center',width:"85px",sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'fplx',title:'发票类型',align:'center',width:"85px",sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'fpdm',title:'发票代码',align:'center',width:"95px",sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'fphm',title:'发票号码',align:'center',width:"85px",sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'kprq',title:'开票日期',align:'center',width:"90px",sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'yzmSj',title:'验证时间',align:'center',width:"145px",sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'jqbm',title:'机器编码',align:'center',width:"110px",sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'gfName',title:'购方名称',align:'center',sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'gfNsrsbh',title:'购方识别号',align:'center',width:"170px",sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'gfAddressTel',title:'购方联系地址',align:'center',sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'gfBankZh',title:'购方开户行',align:'center',sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'fxqy',title:'风险企业验证',align:'center',width:"92px",sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'sfName',title:'销售方名称',align:'center',sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'sfNsrsbh',title:'销售方识别号',align:'center',width:"170px",sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'sfAddressTel',title:'销售方联系地址',align:'center',sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'sfBankZh',title:'销售方开户行',align:'center',sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'jshjL',title:'价税合计',align:'center',width:"145px",sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'jshjU',title:'价税合计(大写)',align:'center',sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'qd',title:'有无清单',align:'center',width:"80px",sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'bz',title:'备注',align:'center',sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'zpListString',title:'商品列表',align:'center',sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
            {field:'jym',title:'检验码',align:'center',width:"180px",sortable:true,
                sorter:function(a,b) { return (a < b ? 1 : -1); }
            },
        ]],
        onLoadSuccess: function() {
            showHideCol();
        }
    });

</script>
</body>
</html>